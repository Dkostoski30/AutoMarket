@model IEnumerable<AutoMarket.Models.Listing>
@using PagedList.Mvc;
@using PagedList;
@using AutoMarket.Models;
@{
    ViewBag.Title = "Home";
    var cities = ViewBag.Cities;
    /*var news_articles = ViewBag.NewsArticles;*/
    var blogs = ViewBag.Blogs as IPagedList<Blog>;
}

<style>
    body {
        font-family: 'Roboto', sans-serif;
        background-color: #121212; /* Very Dark Grey Background */
        color: #E0E0E0; /* Light Grey Text */
        margin: 0;
    }

    /* Navbar Styles */
    .navbar {
        background: linear-gradient(90deg, #1F2C38 0%, #2C3E50 100%); /* Dark Blue Gradient */
        padding: 15px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    }

    .navbar-brand {
        font-weight: bold;
        font-size: 1.5em;
        color: #E0E0E0 !important; /* Light Grey */
        display: flex;
        align-items: center;
    }

        .navbar-brand span {
            color: #1F2C38; /* Dark Blue */
            background-color: #E0E0E0; /* Light Grey */
            padding: 0 8px;
            border-radius: 5px;
        }

    .nav-link {
        color: #E0E0E0 !important;
        margin: 0 10px;
        transition: color 0.3s ease;
    }

        .nav-link:hover {
            color: #18BC9C !important; /* Emerald Green on Hover */
        }

    .navbar-toggler {
        border: none;
        color: #E0E0E0;
    }

    /* Hero Section */
    .hero {
        height: 60vh;
        display: flex;
        justify-content: center;
        align-items: center;
        color: #E0E0E0;
        text-align: center;
        padding: 0 20px;
        background: linear-gradient(90deg, #1F2C38 0%, #2C3E50 100%); /* Dark Blue Gradient */
    }

        .hero h1 {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .hero .btn {
            font-size: 1.2em;
            padding: 10px 20px;
            border-radius: 30px;
            background: #18BC9C; /* Emerald Green */
            color: #ffffff;
            border: none;
            transition: background 0.3s ease;
        }

            .hero .btn:hover {
                background: #16A085; /* Darker Emerald Green */
            }

    /* Body Content */
    .body-content {
        padding: 20px;
        background-color: #1F2C38; /* Dark Blue */
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        border-radius: 8px;
        margin-top: -50px;
        position: relative;
        z-index: 10;
    }

    /* Form */
    .form {
        max-width: 600px;
        margin: 20px auto;
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
    }

    .form-control {
        width: 100%;
        margin-bottom: 15px;
        padding: 10px;
        border: 1px solid #37474F; /* Dark Grey Border */
        background-color: #263238; /* Darker Grey Background */
        color: #E0E0E0; /* Light Grey Text */
        border-radius: 8px;
    }

        .form-control:focus {
            width: 100%;
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid #16A085; /* Dark Grey Border */
            background-color: #263238; /* Darker Grey Background */
            color: #E0E0E0; /* Light Grey Text */
            border-radius: 8px;
        }

        .form-control.d-inline-block {
            width: auto;
            flex-grow: 1;
            margin-right: 10px;
        }

    .btn {
        background-color: #18BC9C; /* Emerald Green */
        color: #ffffff;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        transition: background 0.3s ease;
    }

        .btn:hover {
            background-color: #16A085; /* Darker Emerald Green */
        }

    .btn-primary {
        background-color: #18BC9C; /* Emerald Green */
    }

    /* Section Headings */
    .section-heading {
        font-size: 2em;
        font-weight: 500;
        text-align: center;
        margin-bottom: 20px;
        color: #E0E0E0; /* Light Grey */
    }

    /* Cards for Content */
    .card {
        border: none;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        overflow: hidden;
        transition: transform 0.2s ease;
        margin: 20px 0;
        background-color: #263238; /* Darker Grey Background */
    }

        .card:hover {
            transform: translateY(-5px);
        }

    .card-img-top {
        border-bottom: 1px solid #37474F; /* Dark Grey Border */
    }

    .card-body {
        padding: 20px;
    }

    .card-title {
        font-size: 1.25em;
        font-weight: bold;
        margin-bottom: 10px;
        color: #E0E0E0; /* Light Grey */
    }

    .card-text {
        color: #B0BEC5; /* Light Grey */
    }

    /* Testimonials */
    .testimonial {
        padding: 20px;
        background: #263238; /* Darker Grey */
        border-left: 5px solid #18BC9C; /* Emerald Green */
        margin: 20px 0;
    }

        .testimonial strong {
            color: #E0E0E0; /* Light Grey */
        }

    /* Footer Styles */
    footer {
        background-color: #1F2C38; /* Dark Blue */
        color: #E0E0E0;
        padding: 30px 0;
        text-align: center;
        margin-top: 20px;
        border-radius: 8px 8px 0 0;
    }

    .footer-links {
        margin-bottom: 20px;
    }

        .footer-links a {
            color: #E0E0E0;
            margin: 0 10px;
            transition: color 0.3s ease;
        }

            .footer-links a:hover {
                color: #18BC9C; /* Emerald Green on Hover */
            }

    .footer-text {
        margin: 0;
    }

    .card-img-top-wrapper {
        position: relative;
        width: 100%;
        padding-top: 75%; /* 4:3 Aspect Ratio (adjust as needed) */
        overflow: hidden;
        background-color: #37474F; /* Fallback background color */
    }

        .card-img-top-wrapper img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

    .map-container {
        width: 100%;
        max-width: 100%;
        background-color: #263238; /* Darker Grey Background */
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        margin-bottom: 20px;
        overflow: hidden;
    }

    .map-svg {
        width: fit-content;
        height: auto;
        object-fit: contain;
    }

    @@media-phone {
        .map-container {
            width: 100%;
            max-width: 100%;
            background-color: #263238; /* Darker Grey Background */
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
            overflow: hidden;
        }

        .map-svg {
            width: fit-content;
            height: auto;
            object-fit: contain;
        }
    }

    .city-card {
        border: none;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        overflow: hidden;
        transition: transform 0.2s ease, background-color 0.3s ease; /* Added background-color transition */
        margin: 20px 0;
        background-color: #263238; /* Darker Grey Background */
        text-align: center;
        color: #E0E0E0; /* Light Grey */
    }

        .city-card:hover {
            transform: translateY(-5px);
        }

    .city-checkbox {
        display: none;
    }

    .city-label {
        display: block;
        cursor: pointer;
        margin: 5px 10px;
        transition: background 0.3s ease;
    }

    .city-checkbox:checked + .city-label .city-card {
        background-color: #18BC9C; /* Emerald Green */
        color: #ffffff; /* White text */
        transform: translateY(-5px); /* Optional: Keep the hover effect */
    }
    /*.city-checkbox:checked + .city-label {
            color: #ffffff;*/ /* White Text */
    /*background-color: #18BC9C;
        }*/
    /* Modal Styles */

    /* News Card */
    .news-card {
        border: none;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        overflow: hidden;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        margin: 20px 0;
        background-color: #263238; /* Darker Grey Background */
        color: #E0E0E0; /* Light Grey */
    }

        .news-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3); /* Enhanced shadow on hover */
        }

    .news-card-img {
        width: 100%;
        height: 180px; /* Fixed height for images */
        object-fit: cover;
        border-bottom: 1px solid #37474F; /* Dark Grey Border */
    }

    /* News Card Body */
    .news-card-body {
        padding: 15px;
    }

    .news-card-title {
        font-size: 1.5em;
        font-weight: 600;
        margin-bottom: 10px;
        color: #E0E0E0; /* Light Grey */
    }

    .news-card-text {
        font-size: 0.95em;
        color: #B0BEC5; /* Light Grey */
        margin-bottom: 10px;
    }

    .news-card-link {
        display: inline-block;
        color: #18BC9C; /* Emerald Green */
        font-weight: 500;
        text-decoration: none;
        transition: color 0.3s ease;
    }

        .news-card-link:hover {
            color: #16A085; /* Darker Emerald Green */
        }

    .blog-card-img {
        width: 100%;
        height: 200px; /* Fixed height for images */
        object-fit: cover;
        border-bottom: 1px solid #37474F; /* Dark Grey Border */
    }
</style>



<section class="hero">
    <div>
        <h1>Welcome to AutoMarket</h1>
        <p>Find the best deals on new and used cars!</p>
        <a href="/Listings/Index" class="btn">Browse Listings</a>
    </div>
</section>


<!-- Body Content -->
<div class="container body-content">
    <!-- Featured Listings -->
    <div class="my-5">
        <h2 class="section-heading">Featured Listings</h2>
        <div class="row">
            <!-- Example of a single listing -->
            @foreach (var item in Model.Take(4))
            {
                Random random = new Random();
                int randomIndex = random.Next(item.Images.Count);
                <div class="col-md-3">
                    <div class="card">
                        <div class="card-img-top-wrapper">
                            <img src="~/Content/Images/car_images/@item.Images.ElementAt(randomIndex).Name" class="card-img-top" alt="Car Title">
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">@item.Title</h5>
                            <p class="card-text"><strong>Price:</strong> <span class="price" data-price="@item.Price">€@Html.DisplayFor(modelItem => item.Price)</span></p>
                            @Html.ActionLink("Details", "Details", "Listings", new { id = item.ID }, new { @class = "btn btn-primary btn-sm" })
                        </div>
                    </div>
                </div>
            }

        </div>
    </div>
    <!-- News Section -->
    @* <div class="my-5">
            <h2 class="section-heading">Latest Car News</h2>
            <div class="row">
                @foreach (var news in news_articles)
                {
                    <div class="col-md-4">
                        <div class="card">
                            <img src="@news.ImageUrl" class="card-img-top" alt="News Image">
                            <div class="card-body">
                                <h5 class="card-title">@news.Title</h5>
                                <p class="card-text">@news.Description</p>
                                <a href="@news.Url" class="btn btn-primary" target="_blank">Read More</a>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>*@
    <!-- News Section -->
    @*   <div class="news-section">
            <h2 class="section-heading">Latest Car News</h2>
            <div id="newsContainer"></div>
        </div>*@
    <!--Blog section-->
    <!-- Blog Section -->
    <div class="blog-section">
        <h2 class="section-heading">Our Latest Blogs!</h2>
        <div class="row">
            @foreach (var blog in blogs)
            {
                int maxLength = 50;
                string description = blog.Content;
                string truncatedDescription = description.Length <= maxLength ? description : description.Substring(0, maxLength) + "..";
                <div class="col-md-4">
                    <div class="card blog-card">
                        <img src="~/Content/Images/blog_images/@blog.ImageUrl" class="card-img-top blog-card-img" alt="Blog Image">
                        <div class="card-body blog-card-body">
                            <h5 class="card-title blog-card-title">@blog.Title</h5>
                            <p class="card-text blog-card-text">@truncatedDescription</p>
                            <p class="blog-card-date">@blog.Date.ToString("MMMM dd, yyyy")</p>
                            <a href="@Url.Action("Details", "Blogs", new { id = blog.ID })" class="blog-card-link">Read More</a>
                        </div>
                    </div>
                </div>
            }
        </div>
        <div class="pagination">
            @Html.PagedListPager(blogs, page => Url.Action("Index", new { page }))
        </div>

    </div>
    <!-- Browse by City -->
    <div class="my-5">
        <h2 class="section-heading">Browse by City</h2>
        <!-- Toggle button to hide/show city checkboxes -->
        <div class="text-right mb-3">
            <button id="toggleCities" class="btn btn-sm btn-secondary">
                Toggle Cities
            </button>
        </div>
        @using (Html.BeginForm("ApplyFilters", "Listings", FormMethod.Get))
        {
            <div class="row" id="citySection">
                @foreach (var city in cities)
                {
                    <div class="col-md-3">
                        <input type="checkbox" id="city-@city.Id" class="city-checkbox" value="@city.Name" name="selectedCities">
                        <label for="city-@city.Id" class="city-label">
                            <div class="card city-card">
                                <div class="card-body">
                                    @city.Name
                                </div>
                            </div>
                        </label>
                    </div>
                }
            </div>
            <div class="text-center my-3">
                <button type="submit" class="btn btn-primary btn-lg">Browse Selected Cities</button>
            </div>
        }
    </div>

    <!-- Map -->
    <!--<div class="map-container">
    <h2 class="section-heading">Our Locations</h2>
    <div class="map-svg" >-->
    <!-- Insert your SVG map code here -->
    <!--<embed src="~/Content/Images/other/mk.svg" type="image/svg+xml"/>
        </div>
    </div>-->
    <!-- Categories and Filters -->
    <div class="mb-5">
        <h2 class="section-heading">Browse by Category</h2>
        <div class="row">
            <div class="col-md-3">
                <div class="card">

                    <div class="card-body">
                        <h5 class="card-title">SUVs</h5>
                        <a href="/Listings/FilterBodyType/1" class="btn btn-primary">Browse SUVs</a>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">

                    <div class="card-body">
                        <h5 class="card-title">Sedans</h5>
                        <a href="/Listings/FilterBodyType/2" class="btn btn-primary">Browse Sedans</a>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">

                    <div class="card-body">
                        <h5 class="card-title">Hatchbacks</h5>
                        <a href="/Listings/FilterBodyType/3" class="btn btn-primary">Browse Hatchbacks</a>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">

                    <div class="card-body">
                        <h5 class="card-title">Coupes</h5>
                        <a href="/Listings/FilterBodyType/4" class="btn btn-primary">Browse Coupes</a>
                    </div>
                </div>
            </div>
            <!-- Repeat for other categories -->
        </div>
    </div>

    <!-- Testimonials -->
    <div class="mb-5">
        <h2 class="section-heading">What Our Customers Say</h2>
        <div class="row">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-img-top-wrapper">
                        <img src="~/Content/Images/other/businessman-posing-standing-with-his-arms-crossed.jpg" style="object-fit: cover" class="card-img-top" alt="Card Image">
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">Leonid Dzajkoski - 4/5</h5>
                        <p class="card-text">"An excellent website with a modern design and useful features; a few minor improvements could make it perfect."</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-img-top-wrapper">
                        <img src="~/Content/Images/other/31732.jpg" class="card-img-top" alt="Card Image" style="object-fit: cover">
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">Bojana Kostoska - 5/5</h5>
                        <p class="card-text">"I found my dream car effortlessly thanks to this website's intuitive interface and comprehensive listings—an extremely helpful and satisfying experience!"</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-img-top-wrapper">
                        <img src="~/Content/Images/other/man1.jpg" class="card-img-top" alt="Card Image" style="object-fit: cover">
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">Anton Nedelkoski - 5/5</h5>
                        <p class="card-text">"An exceptionally user-friendly and visually appealing website, offering seamless navigation and a modern, cohesive design."</p>
                    </div>
                </div>
            </div>
        </div>
        <hr />
    </div>

</div>


@section scripts{
    <script>
        $(document).ready(function () {
            $('#toggleCities').click(function () {
                $('#citySection').toggle();
                $('#toggleIconCity').toggleClass('fa-chevron-down fa-chevron-right');
            });
        });

    </script>
    <script>
        function formatPrice(price) {
            return price.toLocaleString('de-DE', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
        }
        document.addEventListener("DOMContentLoaded", function () {
            var prices = document.querySelectorAll(".price");
            prices.forEach(function (priceElem) {
                var price = parseFloat(priceElem.getAttribute("data-price"));
                priceElem.textContent = "€" + formatPrice(price);
            });
        });
    </script>
}


